<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>TMDB ‚Üí Blogger Post Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background:#f5f7fa; font-family:'Poppins',sans-serif; }
    .card { border-radius:20px; box-shadow:0 4px 14px rgba(0,0,0,0.1); }
    .output-box { background:#1e1e1e; color:#00ff99; padding:15px; border-radius:10px; height:300px; overflow:auto; }
    .preview-box { background:#fff; padding:20px; border-radius:15px; box-shadow:0 2px 10px rgba(0,0,0,0.1); margin-top:15px; }
    .download-pair, .screenshot-pair { display:flex; gap:10px; margin-bottom:10px; }
    button { border-radius:10px !important; }
    img.preview-img { width:150px; border-radius:10px; object-fit:cover; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
  </style>
</head>
<body class="p-4">
  <div class="container">
    <h2 class="text-center mb-4">üé¨ TMDB ‚Üí Blogger Post Generator</h2>

    <div class="card p-4">
      <div class="mb-3">
        <label class="form-label">TMDB ID / Title</label>
        <input type="text" id="tmdbInput" class="form-control" placeholder="e.g. 550 or Breaking Bad" />
      </div>
      <button class="btn btn-primary mb-4" onclick="fetchTMDB()">Fetch from TMDB</button>

      <div id="fields">
        <div class="row">
          <div class="col-md-6">
            <label class="form-label">Type</label>
            <input id="type" class="form-control" placeholder="movie or series" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Title</label>
            <input id="title" class="form-control" />
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <label class="form-label">Original Title</label>
            <input id="original_title" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Tagline</label>
            <input id="tagline" class="form-control" />
          </div>
        </div>

        <label class="form-label mt-3">Overview</label>
        <textarea id="overview" class="form-control" rows="3"></textarea>

        <div class="row mt-3">
          <div class="col-md-6">
            <label class="form-label">Release / Air Date</label>
            <input id="release_date" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Runtime</label>
            <input id="runtime" class="form-control" />
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-md-6">
            <label class="form-label">Language(s)</label>
            <input id="languages" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Genres</label>
            <input id="genres" class="form-control" />
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-md-6">
            <label class="form-label">Rating</label>
            <input id="rating" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Director / Writer</label>
            <input id="crew" class="form-control" />
          </div>
        </div>

        <label class="form-label mt-3">Cast</label>
        <input id="cast" class="form-control" />

        <label class="form-label mt-3">Poster URL</label>
        <input id="poster" class="form-control" />

        <label class="form-label mt-3">Backdrop URL</label>
        <input id="backdrop" class="form-control" />

        <label class="form-label mt-3">Trailer URL</label>
        <input id="trailer" class="form-control" />
      </div>

      <h5 class="mt-4">Screenshots</h5>
      <div id="screenshots"></div>
      <button class="btn btn-secondary mt-2" onclick="addScreenshot()">+ Add Screenshot</button>

      <h5 class="mt-4">Download Links</h5>
      <div id="download-links"></div>
      <button class="btn btn-secondary mt-2" onclick="addDownload()">+ Add Download Link</button>

      <button class="btn btn-success w-100 mt-4" onclick="generateHTML()">Generate HTML</button>
    </div>

    <h4 class="mt-4">Generated HTML Code</h4>
    <div class="output-box" id="output"></div>

    <h4 class="mt-4">Preview (Blogger Style)</h4>
    <div id="preview" class="preview-box"></div>

    <div class="mt-3 d-flex gap-2">
      <button class="btn btn-outline-primary flex-fill" onclick="copyHTML()">Copy</button>
    </div>
  </div>

<script>
const apiKey = "55b11132b5aef36e8376418dcce756f2";

async function fetchTMDB() {
  const input = document.getElementById("tmdbInput").value.trim();
  if (!input) return alert("Enter TMDB ID or name");

  let data, type = "movie";
  try {
    if (isNaN(input)) {
      const searchM = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(input)}`).then(r=>r.json());
      const searchT = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${apiKey}&query=${encodeURIComponent(input)}`).then(r=>r.json());
      if (searchM.results?.length) {
        data = await fetch(`https://api.themoviedb.org/3/movie/${searchM.results[0].id}?api_key=${apiKey}&append_to_response=credits,videos,images`).then(r=>r.json());
        type = "movie";
      } else if (searchT.results?.length) {
        data = await fetch(`https://api.themoviedb.org/3/tv/${searchT.results[0].id}?api_key=${apiKey}&append_to_response=credits,videos,images`).then(r=>r.json());
        type = "series";
      }
    } else {
      const movie = await fetch(`https://api.themoviedb.org/3/movie/${input}?api_key=${apiKey}&append_to_response=credits,videos,images`);
      if (movie.ok) { data = await movie.json(); type="movie"; }
      else {
        const tv = await fetch(`https://api.themoviedb.org/3/tv/${input}?api_key=${apiKey}&append_to_response=credits,videos,images`);
        if (tv.ok) { data = await tv.json(); type="series"; }
      }
    }

    if (!data) return alert("Not found!");

    document.getElementById("type").value = type;
    document.getElementById("title").value = data.title || data.name || "";
    document.getElementById("original_title").value = data.original_title || data.original_name || "";
    document.getElementById("overview").value = data.overview || "";
    document.getElementById("tagline").value = data.tagline || "";
    document.getElementById("release_date").value = data.release_date || data.first_air_date || "";
    document.getElementById("runtime").value = data.runtime || (data.episode_run_time ? data.episode_run_time[0] : "");
    document.getElementById("languages").value = data.spoken_languages?.map(l=>l.english_name).join(", ");
    document.getElementById("genres").value = data.genres?.map(g=>g.name).join(", ");
    document.getElementById("rating").value = data.vote_average || "";
    document.getElementById("cast").value = data.credits?.cast?.slice(0,5).map(c=>c.name).join(", ");
    const crew = data.credits?.crew?.filter(c=>["Director","Writer","Screenplay"].includes(c.job)).map(c=>c.name).join(", ");
    document.getElementById("crew").value = crew || "";
    document.getElementById("poster").value = data.poster_path ? `https://image.tmdb.org/t/p/w500${data.poster_path}` : "";
    document.getElementById("backdrop").value = data.backdrop_path ? `https://image.tmdb.org/t/p/original${data.backdrop_path}` : "";
    const tr = data.videos?.results?.find(v=>v.type==="Trailer");
    document.getElementById("trailer").value = tr ? `https://www.youtube.com/watch?v=${tr.key}` : "";

    // Auto add screenshots
    const shotContainer = document.getElementById("screenshots");
    shotContainer.innerHTML = "";
    data.images?.backdrops?.slice(0,4).forEach(img=>{
      const url = `https://image.tmdb.org/t/p/original${img.file_path}`;
      const div = document.createElement("div");
      div.className = "screenshot-pair";
      div.innerHTML = `<input class='form-control' value='${url}'><img src='${url}' class='preview-img'>`;
      shotContainer.appendChild(div);
    });

  } catch (e) { console.error(e); alert("TMDB fetch error"); }
}

function addDownload() {
  const div = document.createElement("div");
  div.className = "download-pair";
  div.innerHTML = `<input class="form-control" placeholder="Label"><input class="form-control" placeholder="Download URL">`;
  document.getElementById("download-links").appendChild(div);
}

function addScreenshot() {
  const div = document.createElement("div");
  div.className = "screenshot-pair";
  div.innerHTML = `<input class="form-control" placeholder="Screenshot URL" oninput="this.nextElementSibling.src=this.value"><img src="" class="preview-img">`;
  document.getElementById("screenshots").appendChild(div);
}

function generateHTML() {
  const g = id => document.getElementById(id).value;
  let dls = "", shots = "";
  document.querySelectorAll("#download-links .download-pair").forEach(p=>{
    const l=p.children[0].value, u=p.children[1].value;
    if (l && u) dls += `<a href="${u}" target="_blank" style="display:inline-block;background:#ff4b2b;color:white;padding:10px 18px;border-radius:10px;margin:5px 3px;text-decoration:none;font-weight:600;box-shadow:0 2px 5px rgba(0,0,0,0.2);">${l}</a>`;
  });

  document.querySelectorAll("#screenshots .screenshot-pair input").forEach(inp=>{
    if (inp.value) shots += `<img src="${inp.value}" style="width:100%;border-radius:12px;margin-bottom:10px;box-shadow:0 3px 10px rgba(0,0,0,0.15);">`;
  });

  const html = `
<div style="background:#ffffff;border-radius:15px;box-shadow:0 4px 10px rgba(0,0,0,0.1);padding:20px;font-family:'Poppins',sans-serif;line-height:1.7;">
  <img src="${g("backdrop")}" style="width:100%;border-radius:15px;margin-bottom:15px;">
  <h2 style="color:#e63946;font-weight:700;margin-bottom:10px;">${g("title")} <small style="color:#555;">(${g("type")})</small></h2>
  <p style="font-style:italic;color:#888;">${g("tagline")}</p>
  <p style="margin:15px 0;">${g("overview")}</p>
  <div style="display:flex;gap:15px;align-items:flex-start;flex-wrap:wrap;margin-top:10px;">
    <img src="${g("poster")}" style="width:220px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.15);">
    <div style="flex:1;min-width:250px;">
      <p><b>Genres:</b> ${g("genres")}</p>
      <p><b>Release:</b> ${g("release_date")} | <b>Runtime:</b> ${g("runtime")} min</p>
      <p><b>Language:</b> ${g("languages")}</p>
      <p><b>Rating:</b> ‚≠ê ${g("rating")}</p>
      <p><b>Director/Writer:</b> ${g("crew")}</p>
      <p><b>Cast:</b> ${g("cast")}</p>
    </div>
  </div>
  ${shots ? `<h3 style='margin-top:20px;color:#333;'>üì∏ Screenshots</h3><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:10px;">${shots}</div>` : ""}
  ${g("trailer") ? `<div style="margin-top:20px;"><iframe width="100%" height="360" src="${g("trailer").replace("watch?v=","embed/")}" frameborder="0" allowfullscreen style="border-radius:10px;"></iframe></div>` : ""}
  <div style="margin-top:20px;text-align:center;">${dls}</div>
  <div style="margin-top:10px;color:#999;font-size:13px;">Labels: ${g("genres")}</div>
</div>`;
  document.getElementById("output").innerText = html;
  document.getElementById("preview").innerHTML = html;
}

function copyHTML() {
  navigator.clipboard.writeText(document.getElementById("output").innerText);
  alert("Copied!");
}
</script>
</body>
</html>
