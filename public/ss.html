<!DOCTYPE html>
<html>
<head>
<title>TMDb Post Generator</title>
<style>
body{
  background:#111;
  color:white;
  font-family:Arial;
  padding:20px;
}
.box{
  background:#1a1a1a;
  padding:20px;
  border-radius:10px;
  max-width:750px;
  margin:auto;
}
.row{
  display:flex;
  gap:10px;
  align-items:center;
}
.row input{
  flex:1;
}
.del{
  background:#ff1744;
  color:#fff;
  font-weight:bold;
  border:none;
  padding:10px 14px;
  border-radius:5px;
  cursor:pointer;
}
.add-btn,
button{
  width:100%;
  padding:12px;
  margin:6px 0;
  border:none;
  border-radius:6px;
  font-weight:bold;
}
.add-btn{background:#2979ff;}
button{background:#00e676;color:#000;}
.copy-btn{background:#03a9f4 !important;}
#output{
  white-space:pre-wrap;
  background:#000;
  padding:15px;
  border-radius:8px;
  margin-top:20px;
}
</style>
</head>
<body>

<div class="box">

<h2>TMDb Auto Fetch Post Generator</h2>

<input type="text" id="tmdb" placeholder="Enter TMDb ID">

<button onclick="fetchMovie()">Fetch Details</button>

<h3>Download Buttons</h3>

<div id="downloadContainer"></div>

<button class="add-btn" onclick="addDownloadRow()">+ Add Download Button</button>

<button onclick="generateHTML()">Generate HTML</button>
<button class="copy-btn" onclick="copyHTML()">Copy HTML</button>

<h3>Output HTML</h3>
<div id="output"></div>

</div>

<script>
const api = "https://api.themoviedb.org/3/movie/";
const key = "55b11132b5aef36e8376418dcce756f2";

let MOVIE = {};

function fetchMovie(){
    let id = document.getElementById("tmdb").value;

    if(!id){ alert("Enter TMDb ID"); return; }

    fetch(`${api}${id}?api_key=${key}&append_to_response=videos`)
    .then(res=>res.json())
    .then(data=>{
        MOVIE = data;
        alert("Movie Fetched Successfully!");
    })
    .catch(()=> alert("Invalid TMDb ID"));
}

// ADD DOWNLOAD BUTTON ROW
function addDownloadRow(){
    let container = document.getElementById("downloadContainer");

    let row = document.createElement("div");
    row.className = "row";

    row.innerHTML = `
        <input type="text" class="label" placeholder="Label (e.g. Download 720p)">
        <input type="text" class="url" placeholder="Enter URL">
        <button class="del" onclick="this.parentElement.remove()">Ã—</button>
    `;

    container.appendChild(row);
}

function generateHTML(){

    let overview = MOVIE.overview || "";
    let poster = "https://image.tmdb.org/t/p/original" + MOVIE.poster_path;

    let trailer = MOVIE.videos?.results?.find(v=>v.type === "Trailer")?.key || "";

    // Build all download buttons
    let lines = "";
    document.querySelectorAll(".row").forEach(r=>{
        let label = r.querySelector(".label").value.trim();
        let url = r.querySelector(".url").value.trim();

        if(label !== "" && url !== ""){
            lines += `<a href="${url}" target="_blank">${label}</a>\n`;
        }
    });

    let html = `
<p>${overview}</p>

${lines}

<div class='video' data-embed='${trailer}'></div>

<div class="separator" style="clear: both;">
  <a href="${poster}" style="display: block; padding: 1em 0; text-align: center;">
    <img src="${poster}"/>
  </a>
</div>
`;

    document.getElementById("output").innerText = html.trim();
}

function copyHTML(){
    let text = document.getElementById("output").innerText;
    navigator.clipboard.writeText(text).then(()=> alert("HTML Copied!"));
}
</script>

</body>
</html>
