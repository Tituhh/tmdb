<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TMDB Post Generator</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
      background: #0e0e0e;
      color: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
      max-width: 850px;
      width: 100%;
    }
    h2 {
      text-align: center;
      color: #ff5252;
      margin-bottom: 20px;
    }
    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: none;
      outline: none;
      background: #121212;
      color: #f5f5f5;
    }
    button {
      background: #b71c1c;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #2e7d32; }
    #movieDetails img {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .field {
      margin-bottom: 10px;
    }
    .screenshots {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .screenshots img {
      width: 100%;
      border-radius: 8px;
    }
    textarea#output {
      height: 200px;
      margin-top: 15px;
      resize: none;
    }
    #copyBtn {
      width: 100%;
      margin-top: 10px;
    }
    .download-field {
      display: flex;
      gap: 10px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üé¨ TMDB Post Generator</h2>

    <div class="input-group">
      <input type="text" id="tmdbId" placeholder="Enter Movie Name or TMDB ID">
      <button id="fetchBtn">Fetch</button>
    </div>

    <div id="movieDetails"></div>

    <div id="downloadSection">
      <h3>Add Download Links</h3>
      <div id="downloadLinks"></div>
      <button id="addDownloadBtn">+ Add Download Button</button>
    </div>

    <button id="generateBtn">Generate HTML</button>

    <textarea id="output" readonly></textarea>
    <button id="copyBtn">Copy HTML</button>
  </div>

  <script>
  const apiKey = "55b11132b5aef36e8376418dcce756f2";
  const fetchBtn = document.getElementById("fetchBtn");
  const generateBtn = document.getElementById("generateBtn");
  const copyBtn = document.getElementById("copyBtn");
  const output = document.getElementById("output");
  const movieDetails = document.getElementById("movieDetails");
  const downloadLinks = document.getElementById("downloadLinks");

  let movieData = null;
  let screenshots = [];

  document.getElementById("addDownloadBtn").addEventListener("click", () => {
    const div = document.createElement("div");
    div.className = "download-field";
    div.innerHTML = `
      <input type="text" placeholder="Server Name" class="server-name">
      <input type="url" placeholder="Download URL" class="server-link">
    `;
    downloadLinks.appendChild(div);
  });

  fetchBtn.addEventListener("click", async () => {
    const query = document.getElementById("tmdbId").value.trim();
    if (!query) return alert("Enter a Movie Name or TMDB ID");

    let url;
    if (isNaN(query)) {
      url = \`https://api.themoviedb.org/3/search/movie?api_key=\${apiKey}&query=\${query}\`;
    } else {
      url = \`https://api.themoviedb.org/3/movie/\${query}?api_key=\${apiKey}\`;
    }

    const res = await fetch(url);
    const data = await res.json();
    movieData = isNaN(query) ? data.results[0] : data;
    if (!movieData) return alert("Movie not found!");

    const fullDataRes = await fetch(\`https://api.themoviedb.org/3/movie/\${movieData.id}?api_key=\${apiKey}&append_to_response=credits\`);
    const fullData = await fullDataRes.json();
    movieData = fullData;

    const screenshotsRes = await fetch(\`https://api.themoviedb.org/3/movie/\${movieData.id}/images?api_key=\${apiKey}\`);
    const screenshotsData = await screenshotsRes.json();
    screenshots = screenshotsData.backdrops.slice(0, 4).map(img => \`https://image.tmdb.org/t/p/w500\${img.file_path}\`);

    const genres = movieData.genres?.map(g => g.name).join(", ") || "N/A";
    const cast = movieData.credits?.cast.slice(0, 5).map(c => c.name).join(", ") || "N/A";
    const director = movieData.credits?.crew.find(c => c.job === "Director")?.name || "N/A";

    movieDetails.innerHTML = \`
      <img src="https://image.tmdb.org/t/p/w500\${movieData.poster_path}" alt="\${movieData.title}">
      <div class="field"><strong>Title:</strong> <input type="text" id="title" value="\${movieData.title}"></div>
      <div class="field"><strong>Genre:</strong> <input type="text" id="genre" value="\${genres}"></div>
      <div class="field"><strong>IMDb:</strong> <input type="text" id="imdb" value="\${movieData.vote_average}"></div>
      <div class="field"><strong>Release:</strong> <input type="text" id="release" value="\${movieData.release_date}"></div>
      <div class="field"><strong>Duration:</strong> <input type="text" id="duration" value="\${movieData.runtime} min"></div>
      <div class="field"><strong>Language:</strong> <input type="text" id="language" value="\${movieData.original_language.toUpperCase()}"></div>
      <div class="field"><strong>Director:</strong> <input type="text" id="director" value="\${director}"></div>
      <div class="field"><strong>Cast:</strong> <input type="text" id="cast" value="\${cast}"></div>
      <div class="field"><strong>Overview:</strong> <textarea id="overview">\${movieData.overview}</textarea></div>
      <div class="screenshots">
        \${screenshots.map(s => \`<img src="\${s}" alt="Screenshot">\`).join("")}
      </div>
    \`;
  });

  generateBtn.addEventListener("click", () => {
    if (!movieData) return alert("Fetch movie details first!");

    const title = document.getElementById("title").value;
    const genre = document.getElementById("genre").value;
    const imdb = document.getElementById("imdb").value;
    const release = document.getElementById("release").value;
    const duration = document.getElementById("duration").value;
    const language = document.getElementById("language").value;
    const director = document.getElementById("director").value;
    const cast = document.getElementById("cast").value;
    const overview = document.getElementById("overview").value;

    const servers = [...document.querySelectorAll(".download-field")].map(div => {
      const name = div.querySelector(".server-name").value;
      const link = div.querySelector(".server-link").value;
      return name && link ? \`<a href="\${link}" class="download-btn">\${name}</a>\` : "";
    }).join("\\n");

    const screenshotsHtml = screenshots.map(src => \`<img src="\${src}" alt="Screenshot">\`).join("\\n");

    const html = \`
<link href="https://tituhh.github.io/css/cdn/style.css" rel="stylesheet">

<div class="movie-post">
  <h2>üé¨ \${title} (\${release.split("-")[0]})</h2>
  <img src="https://image.tmdb.org/t/p/w500\${movieData.poster_path}" alt="\${title}">
  <p><strong>Genre:</strong> \${genre}</p>
  <p><strong>IMDb:</strong> ‚≠ê \${imdb}</p>
  <p><strong>Release:</strong> \${release}</p>
  <p><strong>Duration:</strong> \${duration}</p>
  <p><strong>Language:</strong> \${language}</p>
  <p><strong>Director:</strong> \${director}</p>
  <p><strong>Cast:</strong> \${cast}</p>
  <p><strong>Overview:</strong> \${overview}</p>

  <div class="screenshots">\${screenshotsHtml}</div>
  <h3>üì• Download Links:</h3>
  \${servers}
</div>\`;

    output.value = html.trim();
  });

  copyBtn.addEventListener("click", () => {
    output.select();
    document.execCommand("copy");
    alert("HTML Copied!");
  });
  </script>
</body>
</html>
