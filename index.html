<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TMDB Post Generator</title>
  <link href="https://tituhh.github.io/css/cdn/style.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h2>üé¨ TMDB Post Generator</h2>

    <div class="input-group">
      <input type="text" id="tmdbId" placeholder="Enter Movie Name or TMDB ID">
      <button id="fetchBtn">Fetch</button>
    </div>

    <div id="movieDetails" class="details"></div>

    <div id="downloadSection" class="downloads">
      <h3>Add Download Links</h3>
      <div id="downloadLinks"></div>
      <button id="addDownloadBtn">+ Add Download Button</button>
    </div>

    <button id="generateBtn">Generate HTML</button>

    <textarea id="output" rows="10" readonly></textarea>
    <button id="copyBtn">Copy HTML</button>
  </div>

  <script>
  const apiKey = "55b11132b5aef36e8376418dcce756f2";
  const fetchBtn = document.getElementById("fetchBtn");
  const generateBtn = document.getElementById("generateBtn");
  const copyBtn = document.getElementById("copyBtn");
  const output = document.getElementById("output");
  const movieDetails = document.getElementById("movieDetails");
  const downloadLinks = document.getElementById("downloadLinks");

  let movieData = null;

  document.getElementById("addDownloadBtn").addEventListener("click", () => {
    const div = document.createElement("div");
    div.className = "download-field";
    div.innerHTML = `
      <input type="text" placeholder="Server Name" class="server-name">
      <input type="url" placeholder="Download URL" class="server-link">
    `;
    downloadLinks.appendChild(div);
  });

  fetchBtn.addEventListener("click", async () => {
    const query = document.getElementById("tmdbId").value.trim();
    if (!query) return alert("Enter a Movie Name or TMDB ID");

    let url;
    if (isNaN(query)) {
      url = `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${query}`;
    } else {
      url = `https://api.themoviedb.org/3/movie/${query}?api_key=${apiKey}`;
    }

    const res = await fetch(url);
    const data = await res.json();

    movieData = isNaN(query) ? data.results[0] : data;

    if (!movieData) return alert("Movie not found!");

    const screenshotsUrl = `https://api.themoviedb.org/3/movie/${movieData.id}/images?api_key=${apiKey}`;
    const screenshotsRes = await fetch(screenshotsUrl);
    const screenshotsData = await screenshotsRes.json();

    const screenshots = screenshotsData.backdrops.slice(0, 4).map(img => 
      `https://image.tmdb.org/t/p/w500${img.file_path}`
    );

    movieDetails.innerHTML = `
      <img src="https://image.tmdb.org/t/p/w500${movieData.poster_path}" alt="${movieData.title}">
      <p><strong>Title:</strong> ${movieData.title}</p>
      <p><strong>Release:</strong> ${movieData.release_date}</p>
      <p><strong>Rating:</strong> ‚≠ê ${movieData.vote_average}</p>
      <p><strong>Overview:</strong> ${movieData.overview}</p>
      <div class="screenshots">
        ${screenshots.map(s => `<img src="${s}" alt="Screenshot">`).join("")}
      </div>
    `;
  });

  generateBtn.addEventListener("click", () => {
    if (!movieData) return alert("Fetch movie details first!");

    const servers = [...document.querySelectorAll(".download-field")].map(div => {
      const name = div.querySelector(".server-name").value;
      const link = div.querySelector(".server-link").value;
      return name && link ? `<a href="${link}" class="download-btn">${name}</a>` : "";
    }).join("\n");

    const screenshots = [...movieDetails.querySelectorAll(".screenshots img")]
      .map(img => `<img src="${img.src}" alt="Screenshot">`).join("\n");

    const html = `
<link href="https://tituhh.github.io/css/cdn/style.css" rel="stylesheet">

<div class="movie-post">
  <h2>üé¨ ${movieData.title} (${movieData.release_date?.split("-")[0]})</h2>
  <img src="https://image.tmdb.org/t/p/w500${movieData.poster_path}" alt="${movieData.title}">
  <p><strong>Genre:</strong> ${movieData.genre_ids?.join(", ") || "N/A"}</p>
  <p><strong>IMDb:</strong> ‚≠ê ${movieData.vote_average}</p>
  <p><strong>Release:</strong> ${movieData.release_date}</p>
  <p><strong>Overview:</strong> ${movieData.overview}</p>

  <div class="screenshots">${screenshots}</div>
  <h3>üì• Download Links:</h3>
  ${servers}
</div>`;

    output.value = html.trim();
  });

  copyBtn.addEventListener("click", () => {
    output.select();
    document.execCommand("copy");
    alert("HTML Copied!");
  });
  </script>
</body>
</html>
